{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const limit = 15;\n\nexport async function getImages(query, page) {\n    const options = {\n        key: '42653068-ca30bcafd67c2a07aae2cb182',\n        q: query,\n        image_type: 'photo',\n        oriental: 'horizontal',\n        safesearch: 'true',\n        per_page: limit,\n        page: page\n    };\n    const params = new URLSearchParams(options);\n    const link = await axios.get(`${BASE_URL}?${params}`);\n\n    return {\n        hits: link.data.hits,\n        totalHits: link.data.totalHits\n    }\n\n}","export function searchImage(result) {\n    return result.hits.reduce(\n      (html, image) =>\n        html +\n        `<div class=\"container-image-gallery\">\n            <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${image.webformatURL}\"\n                alt=\"${image.tags}\"\n            />\n           <ul class=\"info-list\">\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Likes</p>\n                  <p class=\"info-value\">${image.likes}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Views</p>\n                  <p class=\"info-value\">${image.views}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Comments</p>\n                  <p class=\"info-value\">${image.comments}</p>\n              </li>\n              <li class=\"info-item\">\n                  <p class=\"info-title\">Downloads</p>\n                  <p class=\"info-value\">${image.downloads}</p>\n              </li>\n            </ul>\n        </a>\n        </div>`,\n      ''\n    );\n};","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getImages, limit } from './js/pixabay-api';\nimport { searchImage } from './js/render-functions';\n\n\nconst formEl = document.querySelector('.search');\nconst loaderEl = document.querySelector('.loader');\nconst galleryEl = document.querySelector('.gallery');\nconst buttonEl = document.querySelector('.load-more');\n\n\nlet lightbox;\nlet page = 1;\nlet currentPage = 1;\nlet prevQuery = '';\n\nformEl.addEventListener(\"submit\", onSubmit);\nbuttonEl.addEventListener(\"click\", loadMore);\n\nfunction lightboxProcessing() {\n  return new SimpleLightbox('.gallery-link', {\n    nav: true,\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n}\n\nfunction onSubmit(evt) {\n  evt.preventDefault();\n  const query = formEl.elements.asking.value.trim();\n  currentPage = page;\n  if (query !== prevQuery) {\n    page = 1;\n    prevQuery = query;\n  }\n\n  galleryEl.innerHTML = \"\";\n  loaderEl.style.display = \"block\";\n  buttonEl.style.display = \"none\";\n  bringImg(query, page);\n  formEl.reset();\n}\n\nfunction loadMore() {\n  loaderEl.style.display = \"block\";\n  page += 1;\n\n  if (page === currentPage + 1) {\n    bringImg(prevQuery, page);\n  } else {\n    console.log('The page will be channged.');\n  }\n}\n\nasync function bringImg(query, page) {\n  try {\n    const data = await getImages(query, page);\n\n    if (!query.trim()) {\n      iziToast.error({\n        timeout: 1500,\n        position: 'bottomCenter',\n        message: 'Fill out this form',\n      });\n      loaderEl.style.display = \"none\";\n      return;\n    } else if (data.hits.length === 0) {\n      iziToast.error({\n        timeout: 1500,\n        position: 'bottomCenter',\n        message:\n          'Sorry, there are no images matching your search query. Please, try again!',\n      });\n      loaderEl.style.display = \"none\";\n      return;\n    } else {\n      const imagesHTML = searchImage(data);\n      galleryEl.insertAdjacentHTML('beforeend', imagesHTML);\n      loaderEl.style.display = 'none';\n      if (!lightbox) {\n        lightbox = lightboxProcessing();\n      } else {\n        lightbox.refresh();\n      }\n      scroll();\n      currentPage = page;\n      const totalImg = data.totalHits;\n      const totalPages = Math.ceil(totalImg / limit);\n      if (page >= totalPages) {\n        buttonEl.style.display = 'none';\n        return iziToast({\n          timeout: 1500,\n          position: 'bottomCenter',\n          message: 'Sorry, there are no more images to load!',\n        });\n      } else {\n        buttonEl.style.display = 'block';\n      }\n    }\n  } catch (error) {\n    loaderEl.style.display = 'none';\n    iziToast.error({\n      timeout: 1500,\n      position: 'bottomCenter',\n      message: 'Sorry, processing error. Please, try again!',\n    });\n  }\n}\n\nfunction scroll() {\n  const cardHeight = galleryEl.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({ top: 2 * cardHeight, behavior: 'smooth' });\n}\n\n"],"names":["BASE_URL","limit","getImages","query","page","options","params","link","axios","searchImage","result","html","image","formEl","loaderEl","galleryEl","buttonEl","lightbox","currentPage","prevQuery","onSubmit","loadMore","lightboxProcessing","SimpleLightbox","evt","bringImg","data","iziToast","imagesHTML","scroll","totalImg","totalPages","cardHeight"],"mappings":"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"}